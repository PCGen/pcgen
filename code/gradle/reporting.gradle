/* PCGen code quality tasks. This file specifies the code quality
 * reports to be run as part of the PCGen nightly build. It is
 * called from the main build.gradle file.
 *
 * Usage: gradle allReports
 * 
 * Author: James Dempsey 
 */

checkstyle {
	configFile = new File('code/standards/checkstyle.xml')
	ignoreFailures = true
	showViolations = false
	toolVersion = '7.8.1'
	sourceSets = []
}

pmd {
    // turn off the default rules
    ruleSets = []
	ruleSetFiles = files('code/standards/pmdruleset.xml')
	
	ignoreFailures = true
	sourceSets = []
	toolVersion = "5.7.0"
}

findbugs {
	ignoreFailures = true
//	effort = 'max'
	sourceSets = []
}

tasks.withType(FindBugs) {
	reports {
		xml.enabled false
		html.enabled true
		html.stylesheet resources.text.fromFile('code/standards/fancy-hist.xsl')
		excludeFilterConfig resources.text.fromFile('code/standards/findbugs_ignore.xml')
		reportLevel 'low'
		// While these can be filtered out later, there is a minor speedup to disabling them here.
		omitVisitors = ['Naming', 'CrossSiteScripting', 'DontUseEnum', 'FinalParameters', 'ImmatureClass',
						'DoInsideDoPrivileged', 'CyclomaticComplexity']
	}
}

// unused: dependency-tuple, unused-dependency, duplicate-dependency-class
gradleLint.rules = [
	'dependency-parentheses',
	'unused-exclude-by-dep',
	'unused-exclude-by-conf',
	'rename-nebula-stash',
	'overridden-dependency-version',
	'archaic-wrapper',
	'all-nebula-renames',
]

task allReports { dependsOn = ['checkstyleMain', 'pmdMain', 'findbugsMain', 'lintGradle'] }
